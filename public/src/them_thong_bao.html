<!DOCTYPE html>
<html lang="vn">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Thêm thông báo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/thanh_menu.css" />
    <link rel="stylesheet" href="../css/them_sach.css" />
    <link rel="stylesheet" href="../css/footer.css" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script
      src="https://kit.fontawesome.com/cfbf817f6f.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <div class="wrapper">
      <!--Header-->
      <div class="header">
        <img src="../img/logo.png" alt="LOGO" height="50px" width="auto" />
        <div class="toggle">
          <i class="fas fa-bars"></i>
        </div>
        <script>
          $(document).ready(function () {
            $(".toggle").click(function () {
              $("nav").slideToggle();
            });
          });
        </script>
        <nav>
          <ul class="main-menu">
            <li><a href="../src/trang_chu.html">Trang chủ</a></li>
            <li class="submenu">
              <a href="../src/gioi_thieu_gtc.html">Giới thiệu</a>
              <ul>
                <li>
                  <a href="../src/gioi_thieu_gtc.html">Giới thiệu chung</a>
                </li>
                <li>
                  <a href="../src/gioi_thieu_ddtg.html"
                    >Địa điểm & Thời gian hoạt động</a
                  >
                </li>
                <li>
                  <a href="../src/gioi_thieu_tlap.html">Tài liệu - Ấn phẩm</a>
                </li>
                <li>
                  <a href="../src/gioi_thieu_ttpb.html"
                    >Thông tin các phòng ban</a
                  >
                </li>
                <li><a href="../src/gioi_thieu_sd.html">Sơ đồ thư viện</a></li>
              </ul>
            </li>
            <li><a href="../src/muon_sach.html">Mượn sách</a></li>
            <li class="submenu">
              <a href="../src/lien_he.html">Liên hệ</a>
            </li>
            <!--Icon fontawsome-->
            <li>
              <a href="../src/gio_sach.html"
                ><i class="fas fa-cart-shopping"></i
              ></a>
            </li>
            <li>
              <a href="../src/thong_bao.html"><i class="fas fa-bell"></i></a>
            </li>
            <li>
              <a href="/src/quan_tri.html" id="userLink"><i class="fas fa-user"></i></a>
            </li>
          </ul>
        </nav>
      </div>

      <!--Body-->
      <h1>Thêm thông báo vào thư viện</h1>
      <form id="notiForm">
        <label for="title">Tiêu đề:</label>
        <input type="text" id="title" required /><br />

        <label for="content">Nội dung:</label>
        <textarea id="description" required></textarea><br />

        <button type="button" id="addNoti">Thêm thông báo</button>
      </form>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
      <script type="module">
        // Import necessary Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics.js";
        import {
          getDatabase,
          ref,
          set,
          get,
        } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

        import {
          getAuth,
          onAuthStateChanged,
          createUserWithEmailAndPassword,
        } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";
        // Your Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyCxSUgNPvToIUGldmsUXgGQXF10aSSH2Hs",
          authDomain: "webapplication-19930.firebaseapp.com",
          databaseURL:
            "https://webapplication-19930-default-rtdb.firebaseio.com",
          projectId: "webapplication-19930",
          storageBucket: "webapplication-19930.appspot.com",
          messagingSenderId: "240590364295",
          appId: "1:240590364295:web:072e52f18a04f146c12222",
          measurementId: "G-BJXFDHBEBK",
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        //const auth = getAuth(app);

        // Get a reference to the Realtime Database
        const database = getDatabase(app);
        // Function to add a notification to Firebase
        function addNotification(event) {
            event.preventDefault();
          const title = document.getElementById("title").value;
          const description = document.getElementById("description").value;

          const currentDate = new Date().toISOString().split('T')[0]; // Lấy ngày hiện tại dưới dạng chuỗi YYYY-MM-DD

          const notiRef = ref(database, `noti/${currentDate}`); // Sử dụng ngày tạo thông báo làm key

          const newNotification = {
            Title: title,
            Content: description,
          };

          set(notiRef, newNotification)
            .then(() => {
              alert("Thông báo đã được lưu.");
            })
            .catch((error) => {
              alert.error("Lỗi khi lưu thông báo vào Firebase: ", error);
            });
        }

        // Event listener for the button to add a notification
        document
          .getElementById("addNoti")
          .addEventListener("click", addNotification);
      </script>

      <!--Footer-->
      <div class="footer">
        <div>
          Địa chỉ: Khu phố 6, Phường Linh Trung, Thành phố Thủ Đức, Thành phố Hồ
          Chí Minh.
        </div>
        <div class="social-link">
          <div>Facebook: fb.com/thuvien</div>
          <div>Email: thuvien@gmail.com</div>
          <div>Hotline: 123456789</div>
        </div>
      </div>
    </div>
  </body>
</html>
